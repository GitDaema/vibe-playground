{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "GraphCommand",
  "description": "Schema for validating graph manipulation commands parsed from natural language.",
  "type": "object",
  "required": ["action"],
  "properties": {
    "action": {
      "type": "string",
      "enum": ["add_nodes", "add_edges", "set_goal", "unknown"]
    },
    "nodes": {
      "type": "array",
      "items": { "type": "string" },
      "description": "An array of node IDs to be added."
    },
    "edges": {
      "type": "array",
      "items": {
        "type": "array",
        "items": { "type": "string" },
        "minItems": 2,
        "maxItems": 2
      },
      "description": "An array of edge pairs, where each pair is [from, to]."
    },
    "start": {
      "type": "string",
      "description": "The ID of the start node."
    },
    "goal": {
      "type": "string",
      "description": "The ID of the goal node."
    },
    "text": {
      "type": "string",
      "description": "The original text if the action is unknown."
    }
  },
  "additionalProperties": false,
  "if": {
    "properties": { "action": { "const": "add_nodes" } }
  },
  "then": {
    "required": ["action", "nodes"]
  },
  "if": {
    "properties": { "action": { "const": "add_edges" } }
  },
  "then": {
    "required": ["action", "edges"]
  },
  "if": {
    "properties": { "action": { "const": "set_goal" } }
  },
  "then": {
    "required": ["action"]
  }
}
